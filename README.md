# Novel AI Composer

扑街写手笔力有限，AI救我狗命
一个基于PyQt5的小说编辑器，集成了AI辅助写作功能，界面风格参考VSCode。

## 功能特性

### 1. 界面布局
- VSCode风格的暗色主题界面
- 左侧文件树，右侧编辑器标签页
- 支持多文件同时编辑

### 2. 文件管理
- 支持打开文件夹作为工作区
- 右键菜单支持常规文件操作（新建、重命名、删除）
- 目录分类标记功能：
  - 正文（绿色标签）
  - 设定（蓝色标签）
  - 草稿（橙色标签）

### 3. 编辑功能
- 双击文件进行编辑
- 失去焦点自动保存
- 支持撤销/重做、剪切/复制/粘贴

### 4. AI辅助写作
- 选中文字后显示浮动菜单
- 支持三种AI功能：
  - **续写**：根据上文内容继续写作
  - **扩写**：增加更多细节和描述
  - **缩写**：精简内容，保留核心信息
  - **自定义指令**
- 流式输出，实时显示生成内容

### 5. 设置功能
- 配置OpenAI API：
  - API Key
  - Base URL（支持自定义端点）
  - 模型选择
- 自定义AI提示词
- 设置自动保存

### 6. 状态保持
- 程序关闭时自动保存：
  - 窗口位置和大小
  - 打开的工作区
  - 打开的文件列表
  - 当前活动文件
- 重启后自动恢复上次工作状态

## 安装说明

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行程序

```bash
python main.py
```

## 使用说明

### 首次使用

1. 启动程序后，点击菜单栏 `文件 > 打开文件夹` 选择工作区
2. 点击菜单栏 `工具 > 设置` 配置OpenAI API信息
3. 在文件树中双击文件开始编辑

### AI功能使用

1. **续写**：将光标放在文本末尾，选中一段文字作为上下文，点击"续写"
2. **扩写**：选中需要扩写的文字，点击"扩写"
3. **缩写**：选中需要精简的文字，点击"缩写"

### 目录分类

右键点击文件树中的目录，选择"标记类别"可以为目录设置分类标签，方便管理不同类型的内容。

## 配置文件

程序会在工作目录下创建以下配置文件：

- `ai_config.json`：AI相关配置（API密钥、提示词等）
- `app_state.json`：程序状态（窗口位置、打开的文件等）
- `directory_categories.json`：目录分类信息

## 注意事项

1. 请确保已安装PyQt5和requests库
2. 使用AI功能前需要配置有效的OpenAI API Key
3. 编辑器会在失去焦点1秒后自动保存
4. 所有配置文件都保存在程序运行目录下

## 技术栈

- **GUI框架**：PyQt5
- **AI接口**：OpenAI API (支持兼容接口)
- **编程语言**：Python 3.x

## 许可证

本项目采用 GPLv3 开源许可证。
